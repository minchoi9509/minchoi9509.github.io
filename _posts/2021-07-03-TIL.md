---
title:  "웹 서버 흐름 및 구조"
excerpt: "차곡차곡 기초부터 단단히 지반공사"

categories: TIL
tags: [Docker, TIL]
---

참고: [TCPschool.com](http://tcpschool.com/webbasic)

### 인터넷 vs 웹
* 인터넷 시스템(Internet System)
	* **TCP/IP** 기본 프로토콜 사용
	* 웹은 인터넷상의 인기있는 하나의 서비스 일 뿐임. 웹은 인터넷에 연결된 사용자들이 서로 정보를 공유 할 수 있는 공간을 의미. HTTP 기본 프로토콜 사용 - http 기본 포트는 80, https 기본 포트는 443
	* 서버와 클라이언트로 구성되어 있음
		* 서버
			* 인터넷 서비스를 제공하는 프로그램이나 컴퓨터
			* 웹 서버(Web Server)
				*  사용자가 컴퓨터나 스마트폰 등 다양한 기기를 사용하여 방문하는 웹 사이트의 정보를 담고 있는 프로그램이나 컴퓨터를 의미함
				* 웹 서버는 사용자가 요청하면 웹 서비스를 항상 제공해야하 함으로 실행되어 있어야 함
				* 사용자가 요청하는 웹 페이지나 프로그램을 실행하여 해당 파일이나 데이터를 사용자에게 제공하는 역할
		* 클라이언트
			* 서버가 제공하는 인터넷 서비스를 이용하는 사용자나 사용자가 사용하는 기기
			* 웹 시스템에서는 웹 사이트를 방문하는 웹 브라우저 포함

### 웹 동작 원리

* 웹 브라우저 요청에서 웹 서버 응답까지 
	1. 사용자가 웹 브라우저를 통해 찾고 싶은 웹 페이지의 URL 주소를 입력함
	2. 사용자가 입력한 URL 주소 중에서 도메인 네임을 **DNS 서버**에서 검색함
	3. DNS 서버에서 해당 도메인 네임에 해당하는 IP 주소를 찾아 사용자가 입력한 URL 정보와 함께 전달함. cmd 창에서 `nslookup` 명령어를 통해서 확인 할 수 있음
	4. 웹 페이지 URL 정보와 전달받은 IP 주소는 웹 기본 프로토콜인 HTTP 프로토콜을 사용하여 **HTTP 요청 메시지**를 생성함.
	5. 생성된 HTTP 요청 메시지는 인터넷 기본 프로토콜인 **TCP 프로토콜을 사용하여 인터넷을 거쳐 해당 IP 주소의 컴퓨터로 전송됨**
	6. 도착한 HTTP 요청 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 URL 정보로 변환됨
	7. 웹 서버에 도착하여 해당하는 데이터 검색하고 응답 함. 
	
### OSI 7 Layer vs TCP/IP 4 Layer
![image](https://user-images.githubusercontent.com/53928609/124388199-c6427900-dd1c-11eb-9194-91fd6d91253a.png)

* OSI 7 Layer
		* 네트워크를 이루고 있는 구성 요소들을 계층적인 방법으로 나누고 표준을 정한 네트워크 모델. 
		* **통신이 일어나는 과정을 단계적으로 파악** 할 수 있기 때문에 흐름을 알기 쉬움
		* 응용, 표현, 세션, 전송, 네트워크, 데이터 링크, 물리 계층

* TCP/IP 4 Layer
	* 인터넷에서 컴퓨터들이 서로 정보를 주고 받는데 쓰이는 통신 규약 - 인터넷 프로토콜을 대표하는 용어
	* 네트워크 엑세스 계층
		* OSI 물리계층과 데이터 링크 계층에 해당함
		* LAN, 패킷망 등에 사용 됨
	* 인터넷 계층
		* OSI 네트워크 계층에 해당됨
		* 라우팅 기능 담당
		* IP 프로토콜
	* 전송 계층
		* OSI 전송 계층에 해당 됨
		* 신뢰성있는 데이터 전송 담당
		* TCP, UDP 프로토콜
	* 응용 계층
		* TCP/UDP 기반의 응용 프로그램 구현 시 사용

* 클라이언트-서버형 아키텍처
    * 수직 분할형 아키텍처 중 하나
    * 클라이언트 : 화면 표시, 단순한 계산은 여기서 실행하고 필요한 경우 서버에 의뢰함
    * 서버 : 업무 애플리케이션, 미들웨어, 데이터 베이스
    * ex) 주식 판매 시스템 > 클라이언트는 그래프 표시, 주가 흐름 분석을 실행하고 서버에서는 주가 데이터를 취득함
    * 업무 애플리케이션이 정기적으로 업데이터 될 때 마다 클라이언트 측의 소프트웨어도 업데이트가 필요함. 
    * 단점
        * 예를 들어 오라클 자바 업데이트 같은 경우에 서버 쪽에서 업데이트가 발생하지만 클라이언트에서 실행하지 않는다면 시스템 위험 요소가 될 수 있음.
        * 서버에 처리가 집중되면 확장성 한계가 발생 할 수 있음

* 3계층형 아키텍처
    * 클라이언트-서버형 아키텍처의 발전형
    * 프레젠테이션 계층, 애플리케이션 계층, 데이터 계층의 3구조로 분할 되어 있음
        * 프레젠테이션 계층 : 사용자 입력을 받음, 웹 브라우저 화면 표시
        * 애플리케이션 계층 : 사용자 요청(Request)에 따른 업무 처리
        * 데이터 계층 : 애플리케이션 요청에 따라 데이터 입출력.

* 프로세스와 스레드
    * 실행 파일 자체가 아니라 OS상에서 실행돼서 어느 정도 독립성을 가지고 동작하는 것
    * 활동하기 위해서는 메모리 공간이 필요하여 커널에 의해 메모리 공간이 할당되어 서버 내부의 디스크상에 설치 됨
    * 하나의 프로세스가 동작하고 있으면 내부에서는 메모리 공간을 점유하는 스레드 하나가 동작하고 있음 (?)
    * 프로세스는 전용 메모리 공간을 가지고 스레드는 다른 스레드와 메모리 공간을 공유함
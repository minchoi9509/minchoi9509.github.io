---
title:  "스트래티지 패턴싱글턴 패턴"
excerpt: "자바 객체지향 디자인 패턴"

categories: JAVA
tags: [JAVA, 디자인패턴, TIL]
---

## 스트래티지 패턴

> 요즘은 안 하지만 열심히 했던 쿠키런 킹덤을 예를 들어보면
> 
> 엄청 많은 종류들의 쿠키들이 존재한는데 기본적으로 쿠키들은 1. 공격한다. 2. 패시브를 사용한다. 라는 공통점을 가지고 있음. 이 구조를 설계해 보자.

-   만약 추상 클래스를 상속 받는 형식으로 구현한다면?
    
    1.  만약 허브맛 쿠키의 패시브를 변경하고 싶은 경우 기존에 구현되어 있던 메서드를 수정해야 한다.
        
    2.  허브맛 쿠키의 `공격한다`라는 기능을 다크 초코맛 쿠키의 `공격한다`라는 기능과 동일하게 변경하는 경우 동일한 기능을 실행하는 중복 메서드를 구현하게 된다.
        
    3.  새로운 신규 쿠키를 구현해야 하는 경우에 캡슐화 단위이므로 단지 쿠키 종류를 추가하는 것은 쉽지만 새로운 쿠키에 공격 및 패시브 방법을 추가하거나 변경 할 때 중복 코드가 발생 할 수 있음. 그리고 이 중복된 코드를 변경해야 하는 경우에는 모든 쿠키에게 가서 변경 해줘야 하는 번거로움이 생김.
        
-   그렇다면 어떻게?
    
    1.  **무엇이 변화해서** 문제가 일어나고 있는지 파악한다. 지금과 같은 경우에는 공격 방식 또는 패시브가 변하는 경우에 따라 문제가 일어난다는 것을 알 수 있다.
        
    2.  공격 방식 / 패시브에 대한 인터페이스를 각각 만들고 이를 구현한 클래스를 만든다.
        

-   스트래티지 패턴은 **전략(=일 수행 방식, 비즈니스 규칙, 문제를 해결한느 알고리즘)을 쉽게 바꿀 수 있도록** 함.

## 싱글턴 패턴
* 단 하나의 객체를 생성해 이를 어디에서든지 참조할 수 있게 하는 것

* 정적 변수, 메서드를 이용해서 Printer(싱글턴 객체) 생성 하는 방법
	``` java
	public Class Printer {
		private static Printer printer = null;
		pricate Printer() {}
		
		public static Printer getPrinter() {
			if (printer == null) {
				printer = new Printer(); // Printer 인스턴스 생성
			}
			return printner;
		}
	}
	```
	* 문제점
		* 단일 스레드일 때는 문제가 없지만 다중 스레드에서 Printer을 사용 할 때 인스턴스 생성 시 문제 발생 > 이 문제 MongoDB 커넥션 풀 생성 할 때 겪었던 문제.  내 나름의 싱글턴 패턴을 구현했던 거라고 생각 했었는데 커넥션 풀이 여러개 생성 되는것 같은 기억이..

	* 해결책
		1. 정적 변수에 인스턴스를 만들어 바로 초기화하는 방법
			`printer` 변수를 null로 초기화하지 않고 인스턴스 생성 후에 사용한다. `priate static Printer printer = new Printer();`
		2. 인스턴스를 만드는 메서드에 동기화 하는 방법
			* `public synchronized static Printer getPrinter()` 
			* 왠지 이 방법을 쓰는 걸 본거 같은 이 기분..?

* 싱글턴 패턴을 굳이 사용하지 않고 정적 메서드로만 이루어진 정적 클래스를 사용해도 동일한 효과를 얻을 수 있음. 
